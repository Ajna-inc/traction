### developer notes

- install python 3.6.13
- install poetry version 1.1.11
- the base docker image is python 3.6.13, so best to develop using that version
- there are issues using poetry lock files generated by a newer version, then run using an older version. the dockerfile uses 1.1.11, so stick with that


### configuration
this plugin requires that acapy is running in multitenant mode. this plugin will load a new Profile Manager in place of the one loaded by Aca-py, and subsequent calls for a Multitenant Profile Manager will use the class configured in this plugin.

the default manager classes provided in this plugin allow multiple tokens per wallet. further configuration for these classes are expected (ie. set timedelta for token expiry *note: it is currently 1 day*).

```
# Multi-tenancy
multitenant: true
jwt-secret: insecure-jwt-secret
multitenant-admin: true


plugin:
  # load this plugin, note multitenant must be true
  - multitenant_provider


plugin-config-value:
  - multitenant_provider.manager_class="my_plugins.manager.MyMultitenantManager"
```

#### askar vs basic/indy

there are 2 multitoken manager classes provided in this plugin: one for indy wallet types, one for askar wallet types.  
if there is no specific configuration provided for `multitenant_provider.manager_class`, we will look at the `wallet_type` (not the `multitenancy-config.wallet_type`). if `wallet_type=askar` then we will load `multitenant_provider.manager.AskarMultitokenMultitenantManager` else we will load `multitenant_provider.manager.BasicMultitokenMultitenantManager`.


### build and run
```
cd docker
docker build -f ./Dockerfile --tag multitenant_provider ..
docker run -it -p 3000:3000 -p 3001:3001 --rm multitenant_provider
```
